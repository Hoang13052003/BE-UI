
# HÆ°á»›ng dáº«n sá»­ dá»¥ng endpoint getAllFeedbacks

Dá»±a trÃªn phÃ¢n tÃ­ch codebase, tÃ´i sáº½ hÆ°á»›ng dáº«n báº¡n cÃ¡ch sá»­ dá»¥ng endpoint `getAllFeedbacks` má»™t cÃ¡ch chi tiáº¿t.

## ğŸ“‹ ThÃ´ng tin cÆ¡ báº£n

- **URL**: `GET /api/feedbacks`
- **Quyá»n truy cáº­p**: Cáº§n authentication (JWT token)
- **Role-based access**: CÃ³ kiá»ƒm soÃ¡t phÃ¢n quyá»n theo role user
- **Return type**: `Page<FeedbackResponseDto>`

## ğŸ” Báº£o máº­t vÃ  PhÃ¢n quyá»n

Endpoint nÃ y cÃ³ **role-based access control** quan trá»ng:
- Há»‡ thá»‘ng sáº½ tá»± Ä‘á»™ng láº¥y thÃ´ng tin user tá»« JWT token
- Dá»±a vÃ o role cá»§a user Ä‘á»ƒ filter data phÃ¹ há»£p
- Náº¿u khÃ´ng cÃ³ JWT token há»£p lá»‡ â†’ tráº£ vá» `401 Unauthorized`

## ğŸ“ Tham sá»‘ Request

### Query Parameters

#### 1. **Pagination Parameters**
```
page=0              // Trang hiá»‡n táº¡i (máº·c Ä‘á»‹nh: 0)
size=10             // Sá»‘ lÆ°á»£ng items per page (máº·c Ä‘á»‹nh: 10)
sortBy=createdAt    // Field Ä‘á»ƒ sort (máº·c Ä‘á»‹nh: createdAt)
direction=desc      // HÆ°á»›ng sort: "asc" hoáº·c "desc" (máº·c Ä‘á»‹nh: desc)
```

#### 2. **Filter Parameters (FeedbackCriteria)**
```
updateId.equals=123           // Filter theo update ID cá»¥ thá»ƒ
projectId.equals=456          // Filter theo project ID cá»¥ thá»ƒ  
read.equals=true              // Filter theo tráº¡ng thÃ¡i Ä‘Ã£ Ä‘á»c (true/false)
createdAt.equals=2024-01-15   // Filter theo ngÃ y táº¡o cá»¥ thá»ƒ
```

## ğŸš€ VÃ­ dá»¥ sá»­ dá»¥ng

### 1. **Get táº¥t cáº£ feedbacks (basic)**
```bash
GET /api/feedbacks
Authorization: Bearer your_jwt_token
```

### 2. **Get feedbacks vá»›i pagination**
```bash
GET /api/feedbacks?page=0&size=20&sortBy=createdAt&direction=desc
Authorization: Bearer your_jwt_token
```

### 3. **Filter feedbacks theo project**
```bash
GET /api/feedbacks?projectId.equals=123&page=0&size=10
Authorization: Bearer your_jwt_token
```

### 4. **Filter feedbacks chÆ°a Ä‘á»c**
```bash
GET /api/feedbacks?read.equals=false&sortBy=createdAt&direction=desc
Authorization: Bearer your_jwt_token
```

### 5. **Filter feedbacks theo ngÃ y vÃ  project**
```bash
GET /api/feedbacks?projectId.equals=456&createdAt.equals=2024-01-15&page=0&size=50
Authorization: Bearer your_jwt_token
```

## ğŸ“¤ Response Format

```json
{
  "content": [
    {
      "id": "507f1f77bcf86cd799439011",
      "userId": 123,
      "fullName": "Nguyen Van A",
      "email": "user@example.com", 
      "updateId": 456,
      "projectId": 789,
      "projectName": "Project ABC",
      "content": "Ná»™i dung feedback...",
      "createdBy": "Nguyen Van A",
      "attachments": [],
      "createdAt": "2024-01-15T10:30:00",
      "read": false,
      "deleted": false
    }
  ],
  "pageable": {
    "sort": {
      "sorted": true,
      "unsorted": false
    },
    "pageNumber": 0,
    "pageSize": 10
  },
  "totalElements": 25,
  "totalPages": 3,
  "last": false,
  "first": true,
  "numberOfElements": 10
}
```

## âš ï¸ LÆ°u Ã½ quan trá»ng vá» báº£o máº­t

1. **Role-based filtering**: Há»‡ thá»‘ng tá»± Ä‘á»™ng filter data dá»±a trÃªn role cá»§a user
   - `ADMIN`: CÃ³ thá»ƒ xem táº¥t cáº£ feedbacks
   - `MANAGER/USER`: Chá»‰ xem Ä‘Æ°á»£c feedbacks liÃªn quan Ä‘áº¿n projects há» Ä‘Æ°á»£c assign

2. **JWT Token**: Báº¯t buá»™c pháº£i cÃ³ trong header `Authorization: Bearer <token>`

3. **Data protection**: Feedbacks Ä‘Ã£ bá»‹ soft delete (`deleted=true`) sáº½ khÃ´ng hiá»ƒn thá»‹

## ğŸ”§ JavaScript/Frontend Usage Example

```javascript
// Async function Ä‘á»ƒ get feedbacks
async function getAllFeedbacks(filters = {}) {
  const params = new URLSearchParams({
    page: filters.page || 0,
    size: filters.size || 10,
    sortBy: filters.sortBy || 'createdAt',
    direction: filters.direction || 'desc',
    ...filters.criteria
  });

  try {
    const response = await fetch(`/api/feedbacks?${params}`, {
      method: 'GET',
      headers: {
        'Authorization': `Bearer ${localStorage.getItem('token')}`,
        'Content-Type': 'application/json'
      }
    });

    if (response.ok) {
      return await response.json();
    } else if (response.status === 401) {
      throw new Error('Unauthorized - Please login again');
    } else {
      throw new Error('Failed to fetch feedbacks');
    }
  } catch (error) {
    console.error('Error fetching feedbacks:', error);
    throw error;
  }
}

// Usage examples
getAllFeedbacks(); // Get táº¥t cáº£ vá»›i default params

getAllFeedbacks({
  page: 0,
  size: 20,
  criteria: {
    'projectId.equals': 123,
    'read.equals': false
  }
}); // Get feedbacks chÆ°a Ä‘á»c cá»§a project 123
```
Endpoint nÃ y Ä‘Æ°á»£c thiáº¿t káº¿ vá»›i **security-first approach**, Ä‘áº£m báº£o data Ä‘Æ°á»£c filter phÃ¹ há»£p vá»›i quyá»n truy cáº­p cá»§a tá»«ng user role.